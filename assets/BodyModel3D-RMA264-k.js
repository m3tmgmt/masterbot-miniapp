import{j as t,r as a,g as b,d as j}from"./index-WG-X-atP.js";import{C as y,u as x,b as g,a as h,P,O as S}from"./body-zones-3d-DWMaaEv7.js";import{H as C}from"./Html-BvAfAIZI.js";function I({zone:e,intensity:o,isSelected:n,onClick:c}){const i=a.useRef(null),{invalidate:r}=x();g(({clock:s})=>{if(i.current)if(n){const f=1+Math.sin(s.getElapsedTime()*4)*.15;i.current.scale.setScalar(f),r()}else i.current.scale.setScalar(1)});const u=o>0?j(o):"#88ccff",p=o>0?b(o):.06,d=a.useCallback(s=>{s&&typeof s=="object"&&"stopPropagation"in s&&s.stopPropagation(),c(e.zoneId)},[c,e.zoneId]);return t.jsxs("mesh",{ref:i,position:e.position,onClick:d,children:[t.jsx("sphereGeometry",{args:[e.radius,16,16]}),t.jsx("meshBasicMaterial",{color:u,transparent:!0,opacity:p,depthWrite:!1})]})}function R({cameraPreset:e,controlsRef:o}){return a.useEffect(()=>{const n=o.current;if(!n||e==="free")return;const c=e==="front"?0:Math.PI;n.setAzimuthalAngle(c),n.setPolarAngle(Math.PI/2),n.update()},[e,o]),null}function w({zone:e}){return t.jsx(C,{position:[e.position[0],e.position[1]+e.radius+.08,e.position[2]],center:!0,pointerEvents:"none",zIndexRange:[100,0],children:t.jsxs("div",{style:{padding:"4px 8px",borderRadius:"6px",backgroundColor:"rgba(17, 24, 39, 0.9)",color:"white",fontSize:"12px",fontWeight:500,whiteSpace:"nowrap",userSelect:"none",border:"1px solid rgba(96, 165, 250, 0.5)",boxShadow:"0 0 8px rgba(59, 130, 246, 0.3)",animation:"zonePulse 2s ease-in-out infinite"},children:[t.jsx("style",{children:`
          @keyframes zonePulse {
            0%, 100% { box-shadow: 0 0 8px rgba(59, 130, 246, 0.3); transform: scale(1); }
            50% { box-shadow: 0 0 16px rgba(59, 130, 246, 0.6); transform: scale(1.05); }
          }
        `}),e.nameRu]})})}function M({selectedZones:e,onZoneClick:o,activeZoneId:n,cameraPreset:c="front"}){const i=a.useRef(null),r=a.useRef(null),[u,p]=a.useState(!0),{invalidate:d}=x();g((l,m)=>{u&&r.current&&(r.current.rotation.y+=m*.5,r.current.rotation.y>=Math.PI*2&&(p(!1),r.current.rotation.y=0),d())});const s=a.useCallback(()=>{u&&(p(!1),r.current&&(r.current.rotation.y=0))},[u]),f=a.useMemo(()=>n?h.find(l=>l.zoneId===n):void 0,[n]);return t.jsxs(t.Fragment,{children:[t.jsx("ambientLight",{intensity:.6}),t.jsx("directionalLight",{position:[2,3,2],intensity:.8}),t.jsx("directionalLight",{position:[-1,2,-2],intensity:.3}),t.jsxs("group",{ref:r,children:[t.jsx(P,{}),h.map(l=>t.jsx(I,{zone:l,intensity:e.get(l.zoneId)??0,isSelected:l.zoneId===n,onClick:o},l.zoneId)),f&&t.jsx(w,{zone:f})]}),t.jsx(S,{ref:i,onStart:s,enablePan:!1,minDistance:2,maxDistance:5,minPolarAngle:Math.PI*.15,maxPolarAngle:Math.PI*.85,target:[0,.3,0],enableDamping:!0,dampingFactor:.1}),t.jsx(R,{cameraPreset:c,controlsRef:i})]})}function E(e){return t.jsx(y,{camera:{position:[0,.5,3.5],fov:40},dpr:[1,1.5],gl:{antialias:!0,powerPreference:"low-power"},style:{width:"100%",height:"100%",touchAction:"none"},children:t.jsx(M,{...e})})}export{E as BodyModel3D};
